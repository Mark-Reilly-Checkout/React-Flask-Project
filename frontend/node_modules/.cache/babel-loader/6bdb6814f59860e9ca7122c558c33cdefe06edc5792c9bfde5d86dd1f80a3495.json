{"ast":null,"code":"/* global ApplePaySession */import React,{useEffect,useRef}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ApplePay=()=>{const containerRef=useRef(null);useEffect(()=>{var _containerRef$current;// Remove any existing button to avoid duplicates\nconst existingButton=document.querySelector('apple-pay-button');if(existingButton)existingButton.remove();// Create new Apple Pay button\nconst applePayButton=document.createElement('apple-pay-button');applePayButton.setAttribute('buttonstyle','black');applePayButton.setAttribute('type','plain');applePayButton.setAttribute('locale','en-US');(_containerRef$current=containerRef.current)===null||_containerRef$current===void 0?void 0:_containerRef$current.appendChild(applePayButton);// Add click listener\napplePayButton.addEventListener('click',handleApplePay);return()=>{applePayButton.removeEventListener('click',handleApplePay);};},[]);const handleApplePay=async()=>{if(!window.ApplePaySession||!ApplePaySession.canMakePayments()){alert(\"Apple Pay is not available on this device/browser.\");return;}const paymentRequest={countryCode:'US',currencyCode:'USD',supportedNetworks:['visa','masterCard','amex'],merchantCapabilities:['supports3DS'],total:{label:'Test Purchase',amount:'50.00'}};const session=new window.ApplePaySession(3,paymentRequest);session.onvalidatemerchant=async event=>{const validationURL=event.validationURL;try{const res=await axios.post(\"/api/apple-pay/validate-merchant\",{validationURL});session.completeMerchantValidation(res.data);}catch(err){console.error(\"Merchant validation failed\",err);session.abort();}};session.onpaymentauthorized=async event=>{const token=event.payment.token;try{const res=await axios.post('/api/apple-pay/session',{tokenData:token.paymentData,amount:5000});if(res.data&&res.data.approved){session.completePayment(window.ApplePaySession.STATUS_SUCCESS);}else{session.completePayment(window.ApplePaySession.STATUS_FAILURE);}}catch(err){console.error('Payment failed',err);session.completePayment(window.ApplePaySession.STATUS_FAILURE);}};session.begin();};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"style\",{children:`\n          apple-pay-button {\n            --apple-pay-button-width: 200px;\n            --apple-pay-button-height: 40px;\n            --apple-pay-button-border-radius: 8px;\n            display: block;\n            margin: 2rem auto;\n            opacity: 0;\n            transform: translateY(20px);\n            animation: fadeInUp 0.6s ease-out forwards;\n            transition: transform 0.3s ease, box-shadow 0.3s ease;\n          }\n\n          apple-pay-button:hover {\n            transform: translateY(15px) scale(1.05);\n            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);\n          }\n\n          @keyframes fadeInUp {\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n        `}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-center\",children:\"Apple Pay\"}),/*#__PURE__*/_jsx(\"div\",{ref:containerRef,className:\"text-center\"})]});};export default ApplePay;","map":{"version":3,"names":["React","useEffect","useRef","axios","jsx","_jsx","jsxs","_jsxs","ApplePay","containerRef","_containerRef$current","existingButton","document","querySelector","remove","applePayButton","createElement","setAttribute","current","appendChild","addEventListener","handleApplePay","removeEventListener","window","ApplePaySession","canMakePayments","alert","paymentRequest","countryCode","currencyCode","supportedNetworks","merchantCapabilities","total","label","amount","session","onvalidatemerchant","event","validationURL","res","post","completeMerchantValidation","data","err","console","error","abort","onpaymentauthorized","token","payment","tokenData","paymentData","approved","completePayment","STATUS_SUCCESS","STATUS_FAILURE","begin","children","className","ref"],"sources":["/Users/mark.reilly/Documents/react-flask-project/frontend/src/components/ApplePay.js"],"sourcesContent":["/* global ApplePaySession */\nimport React, { useEffect, useRef } from 'react';\nimport axios from 'axios';\n\nconst ApplePay = () => {\n  const containerRef = useRef(null);\n\n  useEffect(() => {\n    // Remove any existing button to avoid duplicates\n    const existingButton = document.querySelector('apple-pay-button');\n    if (existingButton) existingButton.remove();\n\n    // Create new Apple Pay button\n    const applePayButton = document.createElement('apple-pay-button');\n    applePayButton.setAttribute('buttonstyle', 'black');\n    applePayButton.setAttribute('type', 'plain');\n    applePayButton.setAttribute('locale', 'en-US');\n    containerRef.current?.appendChild(applePayButton);\n\n    // Add click listener\n    applePayButton.addEventListener('click', handleApplePay);\n\n    return () => {\n      applePayButton.removeEventListener('click', handleApplePay);\n    };\n  }, []);\n\n  const handleApplePay = async () => {\n    if (!window.ApplePaySession || !ApplePaySession.canMakePayments()) {\n      alert(\"Apple Pay is not available on this device/browser.\");\n      return;\n    }\n\n    const paymentRequest = {\n      countryCode: 'US',\n      currencyCode: 'USD',\n      supportedNetworks: ['visa', 'masterCard', 'amex'],\n      merchantCapabilities: ['supports3DS'],\n      total: {\n        label: 'Test Purchase',\n        amount: '50.00',\n      },\n    };\n\n    const session = new window.ApplePaySession(3, paymentRequest);\n\n    session.onvalidatemerchant = async (event) => {\n        const validationURL = event.validationURL;\n        try {\n          const res = await axios.post(\"/api/apple-pay/validate-merchant\", {\n            validationURL\n          });\n          session.completeMerchantValidation(res.data);\n        } catch (err) {\n          console.error(\"Merchant validation failed\", err);\n          session.abort();\n        }\n      };\n\n    session.onpaymentauthorized = async (event) => {\n      const token = event.payment.token;\n\n      try {\n        const res = await axios.post('/api/apple-pay/session', {\n          tokenData: token.paymentData,\n          amount: 5000\n        });\n\n        if (res.data && res.data.approved) {\n          session.completePayment(window.ApplePaySession.STATUS_SUCCESS);\n        } else {\n          session.completePayment(window.ApplePaySession.STATUS_FAILURE);\n        }\n      } catch (err) {\n        console.error('Payment failed', err);\n        session.completePayment(window.ApplePaySession.STATUS_FAILURE);\n      }\n    };\n\n    session.begin();\n  };\n\n  return (\n    <div>\n      <style>\n        {`\n          apple-pay-button {\n            --apple-pay-button-width: 200px;\n            --apple-pay-button-height: 40px;\n            --apple-pay-button-border-radius: 8px;\n            display: block;\n            margin: 2rem auto;\n            opacity: 0;\n            transform: translateY(20px);\n            animation: fadeInUp 0.6s ease-out forwards;\n            transition: transform 0.3s ease, box-shadow 0.3s ease;\n          }\n\n          apple-pay-button:hover {\n            transform: translateY(15px) scale(1.05);\n            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);\n          }\n\n          @keyframes fadeInUp {\n            to {\n              opacity: 1;\n              transform: translateY(0);\n            }\n          }\n        `}\n      </style>\n\n      <h1 className=\"text-center\">Apple Pay</h1>\n      <div ref={containerRef} className=\"text-center\" />\n    </div>\n  );\n};\n\nexport default ApplePay;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}